<!DOCTYPE html>
<head>
    <title>BoxingLab</title>
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    <!--Import Google Icon Font-->
    <link href="css/iconsMaterialDesign.css" rel="stylesheet">
    <!--<link rel="stylesheet" href="css/iconsAwesome.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">-->
    <!--Import materialize.css-->
    <link type="text/css" rel="stylesheet" href="css/materialize.min.css" media="screen,projection" />
    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
    <meta name="google-site-verification" content="tBXM6Tp3mClJbnnRt0raoPoZS3japKLV0QCLig5pUuc" />
    <link href="css/bubble.css" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="css/index.css" />
    <link type="text/css" rel="stylesheet" href="css/comun.css" />
    <link href="css/registrarse.css" rel="stylesheet">
</head>
<body class="b1" >
    <!-- Modal Structure -->
    <div id="modal1" class="modal b2">
        <div class="modal-content b2">
            <h4 class="titulo c3"></h4>
            <p class="texto c4"></p>
        </div>
        <div class="modal-footer b2">
            <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat c4 b3">Aceptar</a>
        </div>
    </div>
        <div class="loader-page b1"><img id="imgLogoCarga" src="img/logoCarga.gif"></div>
    
        <main class="row center">
        <div class="center c4">
            <div id="imgperfil" style="padding: 30px;" class="center col s12" width="500px" height="500px">
                <img id="imgLogo" src="img/logo-transparente.svg" alt="logo">
            </div>
        </div>
        <div class="container" id="vista">
            <div class="z-depth-5 panel-login lighten-4 row" style="display: inline-block; padding: 32px 48px 0px 48px; border: 1px solid #000;">
                <form class="col s12" method="post">
                    <div class='row'>
                        <div class='col s12'>
                            <label>Al continuar aceptas nuestro <a href="http://www.boxinglab.es/legalNotice.html">aviso legal</a> y <a href="http://www.boxinglab.es/privacyPolicy.html">política de privacidad</a></label>
                        </div>
                    </div>
                    <div class='row'>
                        <div class='input-field col s12'>
                            <i class="material-icons prefix">account_circle</i>
                            <input class='validate' type='email' name='email' id='email' />
                            <label for='email'>Email</label>
                        </div>
                    </div>
                    <div class='row'>
                        <div class='input-field col s12'>
                            <i class="material-icons prefix">https</i>
                            <input class='validate' type='password' name='password' id='password' />
                            <label for='password'>Contraseña</label>
                        </div>
                        <label style='float: right;'>
                            <a class='azul' href='#/restablecerContrasena'>
                                <b>¿Olvidaste tu contraseña?</b>
                            </a>
                        </label>
                        
                    </div>
                    <div class='row'>
                        <a name='btn_login' onclick="login()" class='col s12 right btn btn-large waves-effect indigo login'>Iniciar sesión</a>
                    </div>
                    <br />
                    <div class='row'>
                        <a name='creausu' href="#/crearUsuario" class='col s5 btn btn-large waves-effect indigo creausu'>Registrate</a>
                        <a name='btn_invitado' onclick="onOffline()" class='col s5 right btn btn-large waves-effect indigo login'>Invitado</a>
                    </div>
                    <!--<div class="row">
                        <hr>
                    </div>
                    <div class="row">
                        <a class="waves-effect waves-light col s12 btn red" onclick="initGoogle()">
                            <i class="fab fa-google left" style="font-size:25px;margin-top: 5px;"></i>Iniciar con Google</a>
                    </div>-->
                </form>
            </div>
        </div>
    </main>
    <!--Import jQuery before materialize.js-->
    <script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="js/materialize.min.js"></script>
    <script type="text/javascript" src="fonts/iconsAwesome.js"></script>
    <script type="text/javascript" src="js/firebase-5.0.3.js"></script>
    <script type="text/javascript" src="js/firebase.js"></script>
    <script type="text/javascript" src="js/idiomas.js"></script>
    <script type="text/javascript" src="js/bubleslim.js"></script>
    <script type="text/javascript" src="js/animateNumber.js"></script>
    <script type="text/javascript" src="js/libreria.js"></script>
    <script type="text/javascript" src="js/rutas.js"></script>
    <script type="text/javascript" src="js/controladores/user.js"></script>
    <script type="text/javascript" src="js/inicio.js"></script>

    <script type="text/javascript" src="js/funcionesGenerales.js"></script>
    
    
    <script>
        //$("body").css("max-width", screen.width);

        $(".loader-page").css({ visibility: "visible", opacity: "1" });
        
        document.addEventListener("deviceready", onDeviceReady2, false);
        function onOffline() {
            var f = new Date();
            
            var fechaActual = f.getTime();
            localStorage.setItem('BoxingLab-606608-SESION', null);
            var data=JSON.parse(localStorage.getItem('BoxingLab-606608'));
            if(data!=null){
                //data.fechaMod = fechaActual;
                localStorage.setItem('BoxingLab-606608', JSON.stringify(data));
                
            }
            else{
                data={calibrado: 4,
                entrenamientos:null,
                fechaMod: fechaActual,
                logros: [{
                        "logro": "cin500",
                        "valor": 0
                    }, {
                        "logro": "cin1000",
                        "valor": 0
                    }, {
                        "logro": "cin1500",
                        "valor": 0
                    }, {
                        "logro": "cin2000",
                        "valor": 0
                    }, {
                        "logro": "cin3000",
                        "valor": 0
                    }, {
                        "logro": "cin5000",
                        "valor": 0
                    }, {
                        "logro": "recordcalorie",
                        "valor": 0
                    }, {
                        "logro": "recordforce",
                        "valor": 0
                    }, {
                        "logro": "recordhits",
                        "valor": 0
                    }, {
                        "logro": "nivel1",
                        "valor": 0
                    }, {
                        "logro": "nivel2",
                        "valor": 0
                    }, {
                        "logro": "nivel3",
                        "valor": 0
                    }, {
                        "logro": "nivel4",
                        "valor": 0
                    }, {
                        "logro": "nivel5",
                        "valor": 0
                    }],
                perfil: {
                        "altura": "172",
                        "fechanacimiento": "",
                        "idioma": "es",
                        "nombre": "",
                        "peso": "73",
                        "sexo": "hombre",
                    },
                pesosaco:25
                };
                localStorage.setItem('BoxingLab-606608', JSON.stringify(data));
            }
            window.location = "#/inicio";
        }

        function onOnline() {
            /*Accede a firebase*/
            
            firebase.auth().onAuthStateChanged(function (user) {
                if (user) {
                    firebase.database().ref('/users/' + user.uid).once('value').then(function (snapshot) {
                        volcadoDatos(user);
                    });
                } else {
                    $(".loader-page").css({ visibility: "hidden"});
                    $("main").css({ visibility: "visible" });
                }
            });
        }
        
        function onDeviceReady2(){
            var sesion = getParameterURL("sesion");
            if (sesion == "0" || sesion == "1" ) {
                cerrarSesion(sesion);
                $(".loader-page").css({ visibility: "hidden" });
                $("main").css({ visibility: "visible" });
            }
            else {
                var conection=checkConnection();
                
                if(conection== 'No network connection')
                    onOffline()
                else
                    onOnline()

                document.addEventListener("offline", onOffline, false);
                document.addEventListener("online", onOnline, false);
            }
            $(".modal").modal();
        }
    </script>

</body>

</html>